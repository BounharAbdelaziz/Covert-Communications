 function I = conditional_MI(P_T, P_X2_mid_T, W_Y_X1_0_X2, X2_cardinality, Y_cardinality)            % Input:            %   P_T             : a probabilities vector for the time sharing rv            %   P_X2_mid_T    : conditional probability vector P_{X_2 \mid T}             %   W_Y_X1_0_X2     : channel law             % Output: mutual information I(X2;Y \mid X1=0, T)            %   The rate of the non-covert user U2            % R_2 = \sum_{(t,x_2)} p(t)p(x_2 \mid t) \mathbb{D}(W_{Y \mid X_2}(\cdot \mid X_2=x_2) \| \sum_x2' P_X2(x2') W_{Y \mid X2}(\cdot \mid X_2=x2'))                                                            for t=1:length(P_T)                PY(t,:)= (P_X2_mid_T(:,t)')*W_Y_X1_0_X2;                H_Y_X_0_T(t)=-sum( PY(t,:).*log2(PY(t,:)));                for x2=1:X2_cardinality                    H_Y_X1_0_X2_T(x2,t)=-sum( W_Y_X1_0_X2(x2,:).*log2(W_Y_X1_0_X2(x2,:)));                end;                avg_H_Y_X1_0_X2_T(t)= (P_X2_mid_T(:,t)')* H_Y_X1_0_X2_T(:,t);                I_T(t)=H_Y_X_0_T(t) - avg_H_Y_X1_0_X2_T(t);              end;                            I=I_T*P_T;                          end