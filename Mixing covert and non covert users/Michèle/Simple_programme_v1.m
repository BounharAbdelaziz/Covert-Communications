%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Rate Region simulation %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Steps to follow:% - define a simple channel% - verify the constaints (absolute continuity)% - compute the rate% - do a loop on P_T, P_{X2 \mid T}, P_{X1 \mid T} and \epsilon_T%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%clear all;DEBUG_covert=0;DEBUT=0;%% define channelX2_cardinality =2 % can be changedX1_cardinality =2 % fixedY_cardinality = 4 % can be changed W_Y_X1_0_X2=[0.2, 0.3, 0.2, 0.3; 0.2, 0.2, 0.3, 0.3];W_Y_X1_1_X2= [0.23,0.26, 0.22, 0.39; 0.23,0.26, 0.22, 0.29];W_Z_X1_0_X2= [0.3, 0.2, 0.1, 0.4; 0.3, 0.2, 0.15, 0.35];W_Z_X1_1_X2= [0.43,0.05, 0.33, 0.19; 0.23,0.16, 0.42, 0.19]; %% Check conditionsabsolute_continuity_bob= (sum(sum((W_Y_X1_1_X2 >0) | (W_Y_X1_1_X2 ==0)))==0);absolute_continuity_eve= (sum(sum((W_Z_X1_1_X2 >0) | (W_Z_X1_1_X2 ==0)))==0);different_output_distributions_eve = (sum(sum( W_Z_X1_1_X2  ==W_Z_X1_0_X2))>0);  if (absolute_continuity_bob || absolute_continuity_eve || different_output_distributions_eve )   555555   else      %Compute properties of the channels    for x2=1:X2_cardinality           relative_entropy_bob(x2)=InformationTheory.relative_entropy(W_Y_X1_1_X2(x2,:), W_Y_X1_0_X2(x2,:));                difference_Ds(x2)=InformationTheory.relative_entropy(W_Z_X1_1_X2(x2,:), W_Z_X1_0_X2(x2,:))-relative_entropy_bob(x2);                                chi_2 (x2)= InformationTheory.chi_2_distance(W_Z_X1_1_X2(x2,:), W_Z_X1_0_X2(x2,:));    end;  % set secret_key_threshold sk=0.15; % can be changed. Needs to be positive T_cardinality=4 % for comparison can be put to a smaller value N_epochs=10000;  max_epsilon_t=10;      for epoch =1:N_epochs          P_T                 = InformationTheory.generate_probability_vector(T_cardinality,1,1,0,1);        Epsilon_T           = max_epsilon_t*rand(T_cardinality,1);        if (X2_cardinality > 1)            P_X2_mid_T          = InformationTheory.generate_probability_vector(X2_cardinality, T_cardinality,1,0,1);        else            % As it's deterministic            P_X2_mid_T          = ones(X2_cardinality, T_cardinality);        end;                                         %% check whether chosen pmfs satisfy key rate                  for t=1:T_cardinality            numerator_T(t)= Epsilon_T(t)*difference_Ds*P_X2_mid_T(:,t) ;            numerator_r1_T(t)= Epsilon_T(t)*relative_entropy_bob*P_X2_mid_T(:,t) ;            denominator_T(t)= chi_2* P_X2_mid_T(:,t)*(Epsilon_T(t))^2;              end;          numerator=numerator_T*P_T;          denominator=denominator_T*P_T;          sk_ratio=sqrt(2)*numerator./(sqrt(denominator));                            if   sk_ratio >sk            44444          else                                     r1_vect(epoch) = (numerator_r1_T*P_T)./(sqrt(denominator));             r2_vect(epoch)= conditional_MI(P_T, P_X2_mid_T, W_Y_X1_0_X2, X2_cardinality, Y_cardinality);                          end; %end else (sk_rate satisfied)            end; % end epoch    figure(1);plot(r1_vect, r2_vect);end; % end else (channel is good)